<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer Control</title>

    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="main">
            <div class="half aka">
                <div class="aka-control">
                    <p class="aka-name">AKA</p>
                    <button id="ipponAkaButton" onclick="ippon('aka')">ippon</button>
                    <button id="waza-ariAkaButton" onclick="wazaari('aka')">waza-ari</button>
                    <button id="yukoAkaButton" onclick="yuko('aka')">yuko</button>
                    <button id="senshuAkaButton" onclick="showAkaSenshu()">senshu</button>
                    <p id="aka-score">0</p>
                    <button id="akaMinus" onclick="minusScore('aka')">-1</button>

                    <div class="aka-pen-name">
                        <div class="c1">C1</div>
                        <div class="c2">C2</div>
                        <div class="c3">C3</div>
                        <div class="hc">HC</div>
                        <div class="h">H</div>
                    </div>
                    <div class="penalties-aka">
                        <input type="checkbox" id="akac1" onchange="warn(this)">
                        <input type="checkbox" id="akac2" onchange="warn(this)">
                        <input type="checkbox" id="akac3" onchange="warn(this)">
                        <input type="checkbox" id="akahc" onchange="warn(this)">
                        <input type="checkbox" id="akah" onchange="warn(this)">
                    </div>
                </div>
            </div>
            <div class="timer-class">
                <button id="startButton" onclick="startTimer()">Старт</button>
                <button id="pauseButton" onclick="pauseTimer()">Пауза</button>
                <p id="timerDisplay">1:30</p>
            </div>
            <div class="half ao">
                <div class="ao-control">
                    <p class="ao-name">AO</p>
                    <button id="ipponAoButton" onclick="ippon('ao')">ippon</button>
                    <button id="waza-ariAoButton" onclick="wazaari('ao')">waza-ari</button>
                    <button id="yukoAoButton" onclick="yuko('ao')">yuko</button>
                    <button id="senshuAoButton" onclick="showAoSenshu()">senshu</button>
                    <p id="ao-score" onclick="minusScore('ao')">0</p>
                    <button id="aoMinus" onclick="minusScore('ao')">-1</button>

                    <div class="ao-pen-name">
                        <div class="c1">C1</div>
                        <div class="c2">C2</div>
                        <div class="c3">C3</div>
                        <div class="hc">HC</div>
                        <div class="h">H</div>
                    </div>
                    <div class="penalties-ao">
                        <input type="checkbox" id="aoc1" onchange="warn(this)">
                        <input type="checkbox" id="aoc2" onchange="warn(this)">
                        <input type="checkbox" id="aoc3" onchange="warn(this)">
                        <input type="checkbox" id="aohc" onchange="warn(this)">
                        <input type="checkbox" id="aoh" onchange="warn(this)">
                    </div>
                </div>
            </div>
        </div>
        <div class="aside">
            <div class="update-time">
                <p>Изменить время</p>
                <input type="number" id="minutes" value="1">:<input type="number" id="seconds" value="30">
                <br><br><button onclick="updateTime()">Обновить время</button><br><br><br>
            </div>

            <div class="update-tatami">
                <p>Изменить номер татами</p>
                <input type="number" id="tatami-number" value="1">
                <br><br><button onclick="updateTatami()">Обновить</button>
            </div>

            <div class="reset class">
                <br><br><br><button id="resetButton" onclick="resetMatch()">Перезапустить поединок</button>
            </div>

            <div class="openscoreboard class">
                <br><br><button id="openButton" onclick="openOrFocusSecondWindow()">Запустить второй экран</button>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        let AkaVisible = false;
        let AoVisible = false;

        // Функция для обновления времени на втором окне
        function updateTime() {
            let minutes = parseInt(document.getElementById('minutes').value);
            let seconds = parseInt(document.getElementById('seconds').value);

            if (!isNaN(minutes) && !isNaN(seconds)) {
                seconds = minutes * 60 + seconds;
                if (secondWindow && !secondWindow.closed) {
                    secondWindow.postMessage({newTime: seconds}, '*');
                }
                updateTimerr(seconds);
            }
        }

        function updateTatami() {
            let number = parseInt(document.getElementById('tatami-number').value);

            if (!isNaN(number)) {
                if (secondWindow && !secondWindow.closed) {
                    secondWindow.postMessage({newTatami: number}, '*');
                }
            }
        }

        function showAkaSenshu() {
            AkaVisible = !AkaVisible;
            document.getElementById('senshuAkaButton').style.backgroundColor = AkaVisible ? 'rgb(255, 238, 0)' : 'rgb(0, 255, 242)';
            if (secondWindow && !secondWindow.closed) {
                secondWindow.postMessage({ showAkaSenshu: true }, '*');
            }
        }

        function showAoSenshu() {
            AoVisible = !AoVisible;
            document.getElementById('senshuAoButton').style.backgroundColor = AoVisible ? 'rgb(255, 238, 0)' : 'rgb(0, 255, 242)';
            if (secondWindow && !secondWindow.closed) {
                secondWindow.postMessage({ showAoSenshu: true }, '*');
            }
        }
    </script>
</body>
</html>